- **Discovered by**: Soulaimane Hafid (suleif)
- **Severity**: Medium
- **Impact**: Allows the client to trigger a buffer overflow, overwriting memory past `recv_buffer` results in a server crash (DoS)
- **Affected versions**: Starting from commit `4a90979e2f4e16dd5802b88935f75d31c930a701`
- **Technical Summary**: `handlePacket` does not check whether the userâ€‘controlled packet length fits within the recv_buffer . This results in a global variable buffer overflow inside `recv_all`, enabling overwriting of adjacent data and causing a server crash.

```c
int main () {
...
https://github.com/p2r3/bareiron/blob/8e4d4020d7e0797153512768621fba12f0ce68f1/src/main.c#L695
    int length = readVarInt(client_fd);
...
https://github.com/p2r3/bareiron/blob/8e4d4020d7e0797153512768621fba12f0ce68f1/src/main.c#L714
    handlePacket(client_fd, length - sizeVarInt(packet_id), packet_id, state);
...
void handlePacket (int client_fd, int length, int packet_id, int state) {
...
    case 0x1B:
        if (state == STATE_PLAY) {
https://github.com/p2r3/bareiron/blob/8e4d4020d7e0797153512768621fba12f0ce68f1/src/main.c#L195
            recv_all(client_fd, recv_buffer, length, false); <==== !!!! length is not checked
...
    default:
https://github.com/p2r3/bareiron/blob/8e4d4020d7e0797153512768621fba12f0ce68f1/src/main.c#L469
        recv_all(client_fd, recv_buffer, length, false); <===== !!! same here
        break;
...
```
